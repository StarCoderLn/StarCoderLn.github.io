(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{446:function(s,n,e){s.exports=e.p+"assets/img/jenkins1.6e736a08.png"},447:function(s,n,e){s.exports=e.p+"assets/img/jenkins2.6ff05ee0.png"},448:function(s,n,e){s.exports=e.p+"assets/img/jenkins3.0c92d9d0.png"},449:function(s,n,e){s.exports=e.p+"assets/img/jenkins4.2671272e.png"},450:function(s,n,e){s.exports=e.p+"assets/img/jenkins5.65d22623.png"},451:function(s,n,e){s.exports=e.p+"assets/img/jenkins6.2d4dca25.png"},452:function(s,n,e){s.exports=e.p+"assets/img/jenkins7.00ff8751.png"},453:function(s,n,e){s.exports=e.p+"assets/img/jenkins8.af16c43a.png"},454:function(s,n,e){s.exports=e.p+"assets/img/jenkins9.aebdd33e.png"},455:function(s,n,e){s.exports=e.p+"assets/img/jenkins10.4114dc3f.png"},456:function(s,n,e){s.exports=e.p+"assets/img/jenkins11.b220b6de.png"},457:function(s,n,e){s.exports=e.p+"assets/img/jenkins12.1173e044.png"},458:function(s,n,e){s.exports=e.p+"assets/img/jenkins13.922448bb.png"},459:function(s,n,e){s.exports=e.p+"assets/img/jenkins14.2f96d165.png"},460:function(s,n,e){s.exports=e.p+"assets/img/jenkins15.2ebe5f86.png"},461:function(s,n,e){s.exports=e.p+"assets/img/jenkins16.02068286.png"},462:function(s,n,e){s.exports=e.p+"assets/img/jenkins17.0b683e76.png"},463:function(s,n,e){s.exports=e.p+"assets/img/jenkins18.d871bb09.png"},464:function(s,n,e){s.exports=e.p+"assets/img/jenkins19.ac4c7545.png"},465:function(s,n,e){s.exports=e.p+"assets/img/jenkins20.77f6c008.png"},466:function(s,n,e){s.exports=e.p+"assets/img/jenkins21.738580ed.png"},777:function(s,n,e){"use strict";e.r(n);var t=e(33),a=Object(t.a)({},(function(){var s=this,n=s.$createElement,t=s._self._c||n;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("本文主要展示如何在服务器上安装 Jenkins。")]),s._v(" "),t("p",[s._v("Jenkins 可以用来构建发布项目，它本质上是一个流程控制框架，没有插件的话，Jenkins 什么也干不了。")]),s._v(" "),t("h2",{attrs:{id:"安装-java"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装-java"}},[s._v("#")]),s._v(" 安装 Java")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("下载 .rpm 格式的 jdk 安装包到本地电脑。")])]),s._v(" "),t("li",[t("p",[s._v("执行 "),t("a",{attrs:{href:"https://www.runoob.com/linux/linux-comm-scp.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("scp"),t("OutboundLink")],1),s._v(" 命令，将 jdk 安装包上传到服务器上，一般放在 opt 目录中，因为这个目录是用来存放应用程序的。注意，以下命令中的 scl 是我之前创建的免密登录服务器的别名。如果没有配置本地免密登录文件，则需要使用"),t("code",[s._v("服务器登录用户名@ IP 地址或域名")]),s._v("的形式。比如："),t("code",[s._v("scp jdk-14.0.1_linux-x64_bin.rpm root@120.78.199.123:/opt")])])])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("scp")]),s._v(" jdk-14.0.1_linux-x64_bin.rpm scl:/opt\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("执行完毕后，登录服务器就可以看到 opt 目录中已经有上传的安装包了。")]),s._v(" "),t("p",[t("img",{attrs:{src:e(446),alt:"jenkins",title:"jenkins"}})]),s._v(" "),t("ol",{attrs:{start:"3"}},[t("li",[s._v("在服务器上，进入到 opt 目录中，执行 "),t("a",{attrs:{href:"https://www.runoob.com/linux/linux-comm-rpm.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("rpm"),t("OutboundLink")],1),s._v(" 命令进行安装。")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -ivh jdk-14.0.1_linux-x64_bin.rpm\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("这样，Java 开发需要的 jdk 环境就安装成功了。")]),s._v(" "),t("h2",{attrs:{id:"安装-jenkins"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装-jenkins"}},[s._v("#")]),s._v(" 安装 Jenkins")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("我的服务器的系统是 ContOS 7，而"),t("a",{attrs:{href:"https://www.jenkins.io/zh/doc/book/installing/",target:"_blank",rel:"noopener noreferrer"}},[s._v("官网"),t("OutboundLink")],1),s._v("介绍的安装方式中，并没有这个系统的。注意，apt-get 命令是 Ubuntu 系统上的，在 ContOS 7 上安装软件包应该用 yum 命令。")])]),s._v(" "),t("li",[t("p",[s._v("ContOS 7 的 Jenkins 安装包可以从 "),t("a",{attrs:{href:"https://pkg.jenkins.io/redhat/",target:"_blank",rel:"noopener noreferrer"}},[s._v("redhat"),t("OutboundLink")],1),s._v(" 获取，在服务器中执行相应的命令即可完成安装。")])])]),s._v(" "),t("p",[t("img",{attrs:{src:e(447),alt:"jenkins",title:"jenkins"}})]),s._v(" "),t("p",[t("img",{attrs:{src:e(448),alt:"jenkins",title:"jenkins"}})]),s._v(" "),t("ol",{attrs:{start:"3"}},[t("li",[s._v("配置用户名和端口号。首先执行 "),t("code",[s._v("find / -name jenkins")]),s._v(" 命令，可以得到 jenkins 相关的所有目录。")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("/usr/lib/jenkins\n/var/lib/yum/repos/x86_64/7/jenkins\n/var/lib/jenkins\n/var/cache/yum/x86_64/7/jenkins\n/var/cache/jenkins\n/var/log/jenkins\n/run/lock/subsys/jenkins\n/etc/logrotate.d/jenkins\n/etc/sysconfig/jenkins\n/etc/rc.d/init.d/jenkins\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("p",[t("code",[s._v("/etc/sysconfig/jenkins")]),s._v(" 这个就是 jenkins 的配置文件所在的目录。")]),s._v(" "),t("p",[s._v("执行 "),t("code",[s._v("vi /etc/sysconfig/jenkins")]),s._v(" 命令可以进入配置文件中修改用户名和端口号。")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("JENKINS_USER "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root"')]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 防止权限问题")]),s._v("\nJENKINS_PORT "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"8082"')]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 防止端口冲突")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h2",{attrs:{id:"启动-jenkins"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动-jenkins"}},[s._v("#")]),s._v(" 启动 Jenkins")]),s._v(" "),t("ol",[t("li",[s._v("安装完成后，使用 "),t("code",[s._v("service jenkins")]),s._v(" 命令可以查看 jenkins 的一些命令。可以使用 "),t("code",[s._v("service jenkins start")]),s._v(" 命令来启动 jenkins。")])]),s._v(" "),t("p",[t("img",{attrs:{src:e(449),alt:"jenkins",title:"jenkins"}})]),s._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[s._v("此时，在本地电脑的浏览器中访问 "),t("code",[s._v("<你的服务器外网地址>:端口号")]),s._v("，我这里是：http://120.78.199.123:8082/。但是却出现了无法访问的问题。这可能是 jdk 版本不对的原因，可以"),t("a",{attrs:{href:"https://pkg.jenkins.io/redhat/",target:"_blank",rel:"noopener noreferrer"}},[s._v("查看默认支持的 jdk 版本"),t("OutboundLink")],1),s._v("。可以看到默认支持的是8或者11，而我已经安装的是14。")])]),s._v(" "),t("ul",[t("li",[s._v("可以使用以下命令查看已安装的 jdk。")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -qa"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" jdk\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[s._v("卸载已安装的 jdk。")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("yum -y remove jdk-14.0.1-14.0.1-ga.x86_64\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:e(450),alt:"jenkins",title:"jenkins"}})]),s._v(" "),t("ul",[t("li",[s._v("重新安装版本是8的 jdk。")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看所有可安装的版本")]),s._v("\nyum --showduplicate list java*\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装版本为8的jdk")]),s._v("\nyum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" java-1.8.0-openjdk.x86_64\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("然而，换了 jdk 的版本之后还是无法访问，看起来好像不是 jdk 版本的问题。因为后来我又从 Oracle 官网下载了版本11的 jdk，然后像安装版本14那样进行安装，发现还是一样无法访问。")]),s._v(" "),t("ol",{attrs:{start:"3"}},[t("li",[s._v("之后，我又怀疑是防火墙的问题，但是查看了下防火墙状态是关闭的，一开始我还以为这是正常的，后来才知道防火墙得打开。关于 Linux 防火墙的一些常用命令如下：")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看防火墙状态")]),s._v("\nsystemctl status firewalld\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动防火墙")]),s._v("\nsystemctl start firewalld\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 临时关闭防火墙")]),s._v("\nsystemctl stop firewalld\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 永久关闭防火墙")]),s._v("\nsystemctl disable firewalld\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启防火墙")]),s._v("\nsystemctl reload firewalld\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("p",[s._v("不过，打开了防火墙之后还是不行。看到网上资料说可能是没有开放 jenkins 的端口。可以用以下命令看看有没有开放我们设置的 jenkins 端口：8082.")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("firewall-cmd --list-ports\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("如果没有，用下面的命令开放下：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("firewall-cmd --permanent --zone"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("public --add-port"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8082")]),s._v("/tcp\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("然后重启防火墙。")]),s._v(" "),t("p",[s._v("然而，这么一顿操作之后，还是无法访问成功。后来，又看到如果用的是阿里云的 esc 服务器，还得去安全组里配置下。")]),s._v(" "),t("p",[t("img",{attrs:{src:e(451),alt:"jenkins",title:"jenkins"}})]),s._v(" "),t("p",[s._v("配置好之后，再次访问，终于可以访问成功啦！😄")]),s._v(" "),t("h2",{attrs:{id:"配置-jenkins"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置-jenkins"}},[s._v("#")]),s._v(" 配置 Jenkins")]),s._v(" "),t("p",[s._v("下面就是根据引导一步一步进行 jenkins 的配置了。")]),s._v(" "),t("ul",[t("li",[s._v("在服务器上执行命令 "),t("code",[s._v("cat /var/lib/jenkins/secrets/initialAdminPassword")]),s._v(" 获取密码，然后粘贴到这里登录。")])]),s._v(" "),t("p",[t("img",{attrs:{src:e(452),alt:"jenkins",title:"jenkins"}})]),s._v(" "),t("ul",[t("li",[s._v("奇怪的是，点继续之后，看到的并不是常见的安装插件的引导页，而是直接进入了主页面，还是英文的。😳")])]),s._v(" "),t("p",[t("img",{attrs:{src:e(453),alt:"jenkins",title:"jenkins"}})]),s._v(" "),t("p",[s._v("于是只好自己去安装一个中文插件："),t("code",[s._v("Localization: Chinese (Simplified)")]),s._v("，之后需要使用什么插件再去安装就好了。安装好之后重启，界面就是中文的了。重启之后还跳到了下面创建管理员用户的引导页。")]),s._v(" "),t("ul",[t("li",[s._v("创建管理员用户。")])]),s._v(" "),t("p",[t("img",{attrs:{src:e(454),alt:"jenkins",title:"jenkins"}})]),s._v(" "),t("ul",[t("li",[s._v("实例配置，采用默认的就好了。")])]),s._v(" "),t("p",[t("img",{attrs:{src:e(455),alt:"jenkins",title:"jenkins"}})]),s._v(" "),t("ul",[t("li",[s._v("Jenkins 已准备就绪。")])]),s._v(" "),t("p",[t("img",{attrs:{src:e(456),alt:"jenkins",title:"jenkins"}})]),s._v(" "),t("ul",[t("li",[s._v("点击开始使用 Jenkins，就可以看到我们一开始见到的主界面了。")])]),s._v(" "),t("p",[t("img",{attrs:{src:e(457),alt:"jenkins",title:"jenkins"}})]),s._v(" "),t("ul",[t("li",[s._v("替换插件更新源。在 "),t("code",[s._v("系统管理 -> 插件管理 -> 高级 -> 升级站点")]),s._v(" 中把原来的 "),t("code",[s._v("https://updates.jenkins.io/update-center.json")]),s._v(" 替换成清华源 "),t("code",[s._v("https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json")]),s._v("。然后点击提交和立即获取。")])]),s._v(" "),t("p",[s._v("到此，整个 Jenkins 的启动与配置就完成啦～接下来可以开心的使用啦。😄")]),s._v(" "),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("读取设置不要随便点确定，否则之前所有的配置就会没了。除非配置乱了，需要重新开始配置。")])]),s._v(" "),t("li",[t("p",[s._v("已安装插件列表中那些不能点击卸载的插件是因为它们是其他插件的依赖，有其他插件依赖了它们，所以不能卸载，除非依赖它们的插件被卸载了，它们才可以被卸载。")])]),s._v(" "),t("li",[t("p",[s._v("已安装的插件是不会出现在可选插件列表中的。")])]),s._v(" "),t("li",[t("p",[s._v("做 Node.js 项目需要安装的插件有：")])])]),s._v(" "),t("ul",[t("li",[t("p",[t("strong",[s._v("NodeJS Plugin")])])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("Git PreBuildMerge Trait Plugin")])])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("GitHub Integration Plugin")])])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("Publish Over SSH")])])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("SSH Agent Plugin")])])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("Workspace Cleanup Plugin")])])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("Build Timeout")])])])]),s._v(" "),t("p",[s._v("之后缺少的插件再去 "),t("a",{attrs:{href:"https://plugins.jenkins.io/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Jenkins 的插件商店"),t("OutboundLink")],1),s._v("上找就行了。")]),s._v(" "),t("ol",{attrs:{start:"5"}},[t("li",[t("p",[s._v("如果需要扩容的话，需要在节点管理里配置，增加节点。")])]),s._v(" "),t("li",[t("p",[s._v("Jenkins 命令行是 Jenkins 的客户端，使用挺麻烦的，一般用不着。脚本命令行是可以用 Groovy 去编写脚本，忽略就行了，用不着。")])]),s._v(" "),t("li",[t("p",[s._v("Managed files 是用来给 Jenkins 写配置文件的，一般也用不着。")])]),s._v(" "),t("li",[t("p",[s._v("必须等任务执行完成后，才能点准备关机，不然的话任务执行流程会出问题，数据可能会受到破坏。而且一旦点了准备关机之后，就不会接收构建新任务了。")])])])]),s._v(" "),t("h2",{attrs:{id:"新建-jenkins-任务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#新建-jenkins-任务"}},[s._v("#")]),s._v(" 新建 Jenkins 任务")]),s._v(" "),t("ol",[t("li",[s._v("输入任务名称，并选择构建的项目类型，一般选择第一个就行了，下面的都是比较复杂的项目才需要的。")])]),s._v(" "),t("p",[t("img",{attrs:{src:e(458),alt:"jenkins",title:"jenkins"}})]),s._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[s._v("配置 Git 仓库地址，但是配置的时候却出现了以下问题。")])]),s._v(" "),t("p",[t("img",{attrs:{src:e(459),alt:"jenkins",title:"jenkins"}})]),s._v(" "),t("p",[s._v("出现这个问题的原因是，服务器上没有装 Git，执行 "),t("code",[s._v("yum install git")]),s._v(" 命令，安装 Git。安装完成后，再执行 "),t("code",[s._v("which git")]),s._v(" 或者 "),t("code",[s._v("whereis git")]),s._v(" 命令，查看 Git 的安装路径。")]),s._v(" "),t("ol",{attrs:{start:"3"}},[t("li",[s._v("配置好代码仓库地址，我这里用的是 Gitee，因为 Github 实在是太慢了，代码一直拉不下来。")])]),s._v(" "),t("p",[t("img",{attrs:{src:e(460),alt:"jenkins",title:"jenkins"}})]),s._v(" "),t("ol",{attrs:{start:"4"}},[t("li",[s._v("编写构建脚本。")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装依赖")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打包")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" run build\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将打包后的文件复制到指定目录中")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" -r docs/.vuepress/dist /etc/nginx\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[t("img",{attrs:{src:e(461),alt:"jenkins",title:"jenkins"}})]),s._v(" "),t("ol",{attrs:{start:"5"}},[t("li",[s._v("因为我的项目是用 VuePress 搭建的，所以还需要在服务器上装好 Node 环境和安装 VuePress。")])]),s._v(" "),t("ul",[t("li",[t("p",[t("RouterLink",{attrs:{to:"/server/esc.html#安装-node"}},[s._v("安装 Node")])],1)]),s._v(" "),t("li",[t("p",[s._v("VuePress 的安装直接使用 cnpm 就可以了，使用 npm 太慢了。")])])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("cnpm "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -g vuepress\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ol",{attrs:{start:"6"}},[t("li",[s._v("Jankins 配置环境变量")])]),s._v(" "),t("p",[s._v("我们在服务器上装好 Node 环境后，还需要在 Jenkins 上配置环境变量，才能正常使用。在 "),t("code",[s._v("系统管理 -> 系统配置 -> 全局属性 -> 环境变量")]),s._v(" 中配置。")]),s._v(" "),t("p",[s._v("先在服务器上通过以下命令查看环境变量值。")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("然后配置如下。")]),s._v(" "),t("p",[t("img",{attrs:{src:e(462),alt:"jenkins",title:"jenkins"}})]),s._v(" "),t("p",[s._v("此时，点击项目的立即构建按钮就可以看到构建成功啦～🤣")]),s._v(" "),t("ol",{attrs:{start:"7"}},[t("li",[s._v("每次构建前自动清空项目的工作空间。需要安装 "),t("code",[s._v("Workspace Cleanup Plugin")]),s._v(" 这个插件，然后在项目配置的构建环境那里进行配置。")])]),s._v(" "),t("p",[t("img",{attrs:{src:e(463),alt:"jenkins",title:"jenkins"}})]),s._v(" "),t("ol",{attrs:{start:"8"}},[t("li",[s._v("设置超时时间。需要安装 "),t("code",[s._v("Build Timeout")]),s._v(" 这个插件，然后在项目配置的构建环境那里进行配置。")])]),s._v(" "),t("p",[t("img",{attrs:{src:e(464),alt:"jenkins",title:"jenkins"}})]),s._v(" "),t("ol",{attrs:{start:"9"}},[t("li",[s._v("提交代码后自动进行构建部署。需要安装 "),t("code",[s._v("Generic Webhook Trigger Plugin")]),s._v(" 这个插件，安装完成后配置方法如下。")])]),s._v(" "),t("ul",[t("li",[s._v("在项目配置的构建触发器中勾选 Generic Webhook Trigger，勾选就行了，下面的东西都不用填。")])]),s._v(" "),t("p",[t("img",{attrs:{src:e(465),alt:"jenkins",title:"jenkins"}})]),s._v(" "),t("ul",[t("li",[s._v("点击右上角的登录用户名，然后点左侧的设置，在 API Token 那里点击添加新 Token，再点击生成，然后把生成的 token 复制一份。")])]),s._v(" "),t("p",[t("img",{attrs:{src:e(466),alt:"jenkins",title:"jenkins"}})]),s._v(" "),t("ul",[t("li",[s._v("进入 Gitee 上的项目中，点击管理 -> WebHooks，填写里面的 URL，其他的不用改也不用填写，URL 按照以下格式进行填写。")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("http://[Jenkins 登录用户名]:[上一步生成的 token]@[Jenkins 地址]/generic-webhook-trigger/invoke\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("填写完成后可以点击测试按钮测试是否成功。")]),s._v(" "),t("p",[s._v("到此，当每次提交代码到 Gitee 上时，Jenkins 就会自动进行构建部署了。")])])}),[],!1,null,null,null);n.default=a.exports}}]);