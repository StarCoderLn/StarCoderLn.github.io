(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{519:function(t,s,a){t.exports=a.p+"assets/img/performance16.2ecb26ba.png"},520:function(t,s,a){t.exports=a.p+"assets/img/performance17.58821692.png"},521:function(t,s,a){t.exports=a.p+"assets/img/performance18.55545e43.png"},522:function(t,s,a){t.exports=a.p+"assets/img/performance19.5066a8cb.png"},523:function(t,s,a){t.exports=a.p+"assets/img/performance20.60cb3cb6.png"},524:function(t,s,a){t.exports=a.p+"assets/img/performance21.c73cf530.png"},525:function(t,s,a){t.exports=a.p+"assets/img/performance22.2817cf0a.png"},526:function(t,s,a){t.exports=a.p+"assets/img/performance23.5a58c1c8.png"},527:function(t,s,a){t.exports=a.p+"assets/img/performance24.616798f8.png"},528:function(t,s,a){t.exports=a.p+"assets/img/performance25.00323ac0.png"},740:function(t,s,a){"use strict";a.r(s);var n=a(33),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h2",{attrs:{id:"å†…å­˜æ³„æ¼"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å†…å­˜æ³„æ¼"}},[t._v("#")]),t._v(" å†…å­˜æ³„æ¼")]),t._v(" "),n("p",[t._v("ğŸ“Œ "),n("strong",[t._v("1. ä»€ä¹ˆæ˜¯å†…å­˜æ³„æ¼ï¼Ÿ")])]),t._v(" "),n("ul",[n("li",[n("p",[t._v("ç¨‹åºçš„è¿è¡Œéœ€è¦å†…å­˜ã€‚åªè¦ç¨‹åºæå‡ºè¦æ±‚ï¼Œæ“ä½œç³»ç»Ÿæˆ–è€…è¿è¡Œæ—¶ï¼ˆruntimeï¼‰å°±å¿…é¡»ä¾›ç»™å†…å­˜ã€‚")])]),t._v(" "),n("li",[n("p",[t._v("å¯¹äºæŒç»­è¿è¡Œçš„æœåŠ¡è¿›ç¨‹ï¼ˆdaemonï¼‰ï¼Œå¿…é¡»åŠæ—¶é‡Šæ”¾ä¸å†ç”¨åˆ°çš„å†…å­˜ã€‚å¦åˆ™ï¼Œå†…å­˜å ç”¨è¶Šæ¥è¶Šé«˜ï¼Œè½»åˆ™å½±å“ç³»ç»Ÿæ€§èƒ½ï¼Œé‡åˆ™å¯¼è‡´è¿›ç¨‹å´©æºƒã€‚")])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("ä¸å†ç”¨åˆ°çš„å†…å­˜ï¼Œæ²¡æœ‰åŠæ—¶é‡Šæ”¾ï¼Œå°±å«åšå†…å­˜æ³„æ¼ï¼ˆmemory leakï¼‰")]),t._v("ã€‚")])]),t._v(" "),n("li",[n("p",[t._v("æœ‰äº›è¯­è¨€ï¼ˆæ¯”å¦‚ C è¯­è¨€ï¼‰å¿…é¡»æ‰‹åŠ¨é‡Šæ”¾å†…å­˜ï¼Œç¨‹åºå‘˜è´Ÿè´£å†…å­˜ç®¡ç†ã€‚")])])]),t._v(" "),n("p",[t._v("ğŸ“Œ "),n("strong",[t._v("2. å†…å­˜æ³„æ¼çš„å…·ä½“è¡¨ç°")])]),t._v(" "),n("ul",[n("li",[t._v("æ¯”è¾ƒå¹³ç¨³ï¼Œæ²¡æœ‰å†…å­˜æ³„æ¼")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(519),alt:"performance",title:"performance"}})]),t._v(" "),n("ul",[n("li",[t._v("é€æ­¥ä¸Šå‡ï¼Œè¯´æ˜æœ‰å†…å­˜æ³„æ¼")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(520),alt:"performance",title:"performance"}})]),t._v(" "),n("p",[t._v("ğŸ“Œ "),n("strong",[t._v("3. æµè§ˆå™¨ä¸­å¦‚ä½•æŸ¥çœ‹å†…å­˜æ³„æ¼ï¼Ÿ")])]),t._v(" "),n("p",[t._v("åœ¨"),n("RouterLink",{attrs:{to:"/javascript/jsTest.html#åŸºç¡€æµ‹è¯•-e"}},[t._v("åŸºç¡€æµ‹è¯• E")]),t._v(" ç¬¬ä¸‰é¢˜ä¸­å·²ç»æœ‰æåˆ°è¿‡æ–¹æ³•ã€‚")],1),t._v(" "),n("h2",{attrs:{id:"å‹åŠ›æµ‹è¯•"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å‹åŠ›æµ‹è¯•"}},[t._v("#")]),t._v(" å‹åŠ›æµ‹è¯•")]),t._v(" "),n("p",[t._v("ğŸ“Œ "),n("strong",[t._v("1. PV å’Œ UV")])]),t._v(" "),n("ul",[n("li",[n("p",[t._v("PV æ˜¯æŒ‡"),n("strong",[t._v("é¡µé¢è®¿é—®äººæ¬¡")]),t._v("ï¼ŒUV æ˜¯æŒ‡"),n("strong",[t._v("é¡µé¢è®¿é—®äººæ•°")]),t._v("ã€‚")])]),t._v(" "),n("li",[n("p",[t._v("PV æ¯å¤©å‡ åä¸‡ç”šè‡³ä¸Šç™¾ä¸‡å°±éœ€è¦è€ƒè™‘å‹åŠ›æµ‹è¯•ã€‚æ¢ç®—å…¬å¼æ˜¯ï¼š"),n("code",[t._v("QPS = PV / t")]),t._v("ï¼Œæ¯”å¦‚æœåŠ¡å™¨åœ¨10ä¸ªå°æ—¶å†…å¤„ç†äº†100ä¸‡ä¸ªè¯·æ±‚ï¼Œé‚£ä¹ˆå®ƒçš„ QPS å°±æ˜¯ 1000000 / 10 * 60 * 60 = 27.7ï¼Œæ¯ç§’å¤„ç†27.7ä¸ªè¯·æ±‚ã€‚")])]),t._v(" "),n("li",[n("p",[t._v("QPSï¼ˆQueries Per Secondï¼‰çš„æ„æ€æ˜¯"),n("strong",[t._v("æ¯ç§’æŸ¥è¯¢ç‡")]),t._v("ï¼Œæ˜¯"),n("strong",[t._v("å¯¹ä¸€ä¸ªç‰¹å®šçš„æŸ¥è¯¢ï¼ŒæœåŠ¡å™¨åœ¨è§„å®šæ—¶é—´å†…æ‰€å¤„ç†æµé‡å¤šå°‘çš„è¡¡é‡æ ‡å‡†")]),t._v("ã€‚"),n("code",[t._v("QPS = å¹¶å‘é‡ / å¹³å‡å“åº”æ—¶é—´")])])]),t._v(" "),n("li",[n("p",[t._v("TPSï¼ˆTransactions Per Secondï¼‰çš„æ„æ€æ˜¯"),n("strong",[t._v("äº‹åŠ¡æ•°/ç§’")]),t._v("ï¼Œå®ƒæ˜¯è½¯ä»¶æµ‹è¯•ç»“æœçš„æµ‹é‡å•ä½ã€‚ä¸€ä¸ªäº‹åŠ¡æ˜¯æŒ‡ä¸€ä¸ªå®¢æˆ·æœºå‘æœåŠ¡å™¨å‘é€è¯·æ±‚ç„¶åæœåŠ¡å™¨åšå‡ºååº”çš„è¿‡ç¨‹ã€‚å®¢æˆ·æœºåœ¨å‘é€è¯·æ±‚æ—¶å¼€å§‹è®¡æ—¶ï¼Œæ”¶åˆ°æœåŠ¡å™¨å“åº”åç»“æŸè®¡æ—¶ï¼Œä»¥æ­¤æ¥è®¡ç®—ä½¿ç”¨çš„æ—¶é—´å’Œå®Œæˆçš„äº‹åŠ¡ä¸ªæ•°ã€‚")])])]),t._v(" "),n("p",[t._v("ğŸ“Œ "),n("strong",[t._v("2. WRK")])]),t._v(" "),n("ul",[n("li",[n("p",[n("a",{attrs:{href:"https://github.com/wg/wrk",target:"_blank",rel:"noopener noreferrer"}},[t._v("wrk"),n("OutboundLink")],1),t._v(" æ˜¯ä¸€æ¬¾ç®€å•çš„ HTTP å‹æµ‹å·¥å…·ã€‚")])]),t._v(" "),n("li",[n("p",[n("a",{attrs:{href:"https://www.cnblogs.com/quanxiaoha/p/10661650.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("wrk ä½¿ç”¨æ•™ç¨‹"),n("OutboundLink")],1)])]),t._v(" "),n("li",[n("p",[t._v("wrk çš„å­å‘½ä»¤å‚æ•°çš„å«ä¹‰")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("å­å‘½ä»¤")]),t._v(" "),n("th",[t._v("å«ä¹‰")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("-c, --connections")]),t._v(" "),n("td",[t._v("è·ŸæœåŠ¡å™¨å»ºç«‹å¹¶ä¿æŒçš„ TCP è¿æ¥æ•°é‡")])]),t._v(" "),n("tr",[n("td",[t._v("-d, --duration")]),t._v(" "),n("td",[t._v("å‹æµ‹æ—¶é—´")])]),t._v(" "),n("tr",[n("td",[t._v("-t, --threads")]),t._v(" "),n("td",[t._v("ä½¿ç”¨å¤šå°‘ä¸ªçº¿ç¨‹è¿›è¡Œå‹æµ‹")])]),t._v(" "),n("tr",[n("td",[t._v("-s, --script")]),t._v(" "),n("td",[t._v("æŒ‡å®š Lua è„šæœ¬è·¯å¾„")])]),t._v(" "),n("tr",[n("td",[t._v("-H, --header")]),t._v(" "),n("td",[t._v("ä¸ºæ¯ä¸€ä¸ª HTTP è¯·æ±‚æ·»åŠ  HTTP å¤´")])]),t._v(" "),n("tr",[n("td",[t._v("--latency")]),t._v(" "),n("td",[t._v("åœ¨å‹æµ‹ç»“æŸåï¼Œæ‰“å°å»¶è¿Ÿç»Ÿè®¡ä¿¡æ¯")])]),t._v(" "),n("tr",[n("td",[t._v("--timeout")]),t._v(" "),n("td",[t._v("è¶…æ—¶æ—¶é—´")])]),t._v(" "),n("tr",[n("td",[t._v("-v, --version")]),t._v(" "),n("td",[t._v("ç‰ˆæœ¬å·ä¿¡æ¯")])])])])]),t._v(" "),n("li",[n("p",[t._v("wrk ç”Ÿæˆçš„æŠ¥å‘Šä¸­çš„å­—æ®µå«ä¹‰")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("å­—æ®µå")]),t._v(" "),n("th",[t._v("å«ä¹‰")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("Avgï¼ˆå¹³å‡å€¼ï¼‰")]),t._v(" "),n("td",[t._v("æ¯æ¬¡æµ‹è¯•çš„å¹³å‡å€¼")])]),t._v(" "),n("tr",[n("td",[t._v("Stdevï¼ˆæ ‡å‡†å·®ï¼‰")]),t._v(" "),n("td",[t._v("ç»“æœçš„ç¦»æ•£ç¨‹åº¦ï¼Œè¶Šå¤§è¯´æ˜è¶Šä¸ç¨³å®š")])]),t._v(" "),n("tr",[n("td",[t._v("Maxï¼ˆæœ€å¤§å€¼ï¼‰")]),t._v(" "),n("td",[t._v("æœ€å¤§çš„ä¸€æ¬¡ç»“æœ")])]),t._v(" "),n("tr",[n("td",[t._v("+/- Stdevï¼ˆæ­£è´Ÿä¸€ä¸ªæ ‡å‡†å·®å æ¯”ï¼‰")]),t._v(" "),n("td",[t._v("ç»“æœçš„ç¦»æ•£ç¨‹åº¦ï¼Œè¶Šå¤§è¯´æ˜è¶Šä¸ç¨³å®š")])]),t._v(" "),n("tr",[n("td",[t._v("Latencyï¼ˆå»¶è¿Ÿï¼‰")]),t._v(" "),n("td",[t._v("å¯ä»¥ç†è§£ä¸ºå“åº”æ—¶é—´")])]),t._v(" "),n("tr",[n("td",[t._v("Req / Secï¼ˆæ¯ç§’è¯·æ±‚æ•°ï¼‰")]),t._v(" "),n("td",[t._v("æ¯ä¸ªçº¿ç¨‹æ¯ç§’å®Œæˆçš„è¯·æ±‚æ•°")])])])])]),t._v(" "),n("li",[n("p",[t._v("ä¸€èˆ¬æ¥è¯´ï¼Œæ¨¡æ‹Ÿçš„çº¿ç¨‹æ•°ä¸å®œå¤ªå¤šï¼Œè®¾ç½®æˆå‹æµ‹æœºå™¨ CPU æ ¸å¿ƒæ•°çš„ 2 å€åˆ° 4 å€å°±å¤Ÿäº†ã€‚æˆ‘ä»¬ä¸»è¦å…³æ³¨å¹³å‡å€¼å’Œæœ€å¤§å€¼ã€‚æ ‡å‡†å·®å¦‚æœå¤ªå¤§è¯´æ˜æ ·æœ¬æœ¬èº«ç¦»æ•£ç¨‹åº¦æ¯”è¾ƒé«˜ï¼Œæœ‰å¯èƒ½ç³»ç»Ÿæ€§èƒ½æ³¢åŠ¨å¾ˆå¤§ã€‚")])])]),t._v(" "),n("p",[t._v("ğŸ“Œ "),n("strong",[t._v("3. Apache JMeter")])]),t._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://github.com/apache/jmeter",target:"_blank",rel:"noopener noreferrer"}},[t._v("Apache JMeter"),n("OutboundLink")],1),t._v(" æ˜¯çº¯ Java ç¼–å†™çš„åº”ç”¨ç¨‹åºï¼Œä¸»è¦ç”¨æ¥åšåŠŸèƒ½æµ‹è¯•å’Œæ€§èƒ½æµ‹è¯•ï¼ˆå‹åŠ›æµ‹è¯•/è´Ÿè½½æµ‹è¯•ï¼‰ã€‚")])]),t._v(" "),n("p",[t._v("ğŸ“Œ "),n("strong",[t._v("4. Node.js å†…å­˜ä¿¡æ¯")])]),t._v(" "),n("ul",[n("li",[t._v("ä¸€ä¸ªè¿è¡Œçš„ç¨‹åºé€šå¸¸æ˜¯é€šè¿‡åœ¨å†…å­˜ä¸­åˆ†é…ä¸€éƒ¨åˆ†ç©ºé—´æ¥è¡¨ç¤ºçš„ã€‚è¿™éƒ¨åˆ†ç©ºé—´è¢«ç§°ä¸º"),n("strong",[t._v("é©»ç•™é›†ï¼ˆResident Setï¼‰")]),t._v("ã€‚V8 çš„å†…å­˜ç®¡ç†æ¨¡å¼æœ‰ç‚¹ç±»ä¼¼äº "),n("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/34426768",target:"_blank",rel:"noopener noreferrer"}},[t._v("Java è™šæ‹Ÿæœºï¼ˆJVMï¼‰"),n("OutboundLink")],1),t._v("ï¼Œå®ƒä¼šå°†å†…å­˜è¿›è¡Œåˆ†æ®µã€‚")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(521),alt:"performance",title:"performance"}})]),t._v(" "),n("ul",[n("li",[n("p",[n("a",{attrs:{href:"http://nodejs.cn/api/process/process_memoryusage.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("process.memoryUsage()"),n("OutboundLink")],1),t._v(" ä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«äº† Node.js è¿›ç¨‹çš„å†…å­˜å ç”¨ä¿¡æ¯ã€‚è¯¥å¯¹è±¡åŒ…å«å››ä¸ªå­—æ®µï¼Œå•ä½æ˜¯å­—èŠ‚ã€‚")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("å­—æ®µ")]),t._v(" "),n("th",[t._v("å«ä¹‰")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("rss(resident set size)")]),t._v(" "),n("td",[t._v("æ‰€æœ‰å†…å­˜å ç”¨ï¼ŒåŒ…æ‹¬æŒ‡ä»¤åŒºå’Œå †æ ˆ")])]),t._v(" "),n("tr",[n("td",[t._v("heapTotal")]),t._v(" "),n("td",[t._v("â€œå †â€å ç”¨çš„å†…å­˜ï¼ŒåŒ…æ‹¬ç”¨åˆ°çš„å’Œæ²¡ç”¨åˆ°çš„")])]),t._v(" "),n("tr",[n("td",[t._v("heapUsed")]),t._v(" "),n("td",[t._v("ç”¨åˆ°çš„å †çš„éƒ¨åˆ†")])]),t._v(" "),n("tr",[n("td",[t._v("external")]),t._v(" "),n("td",[t._v("V8 å¼•æ“å†…éƒ¨çš„ C++ å¯¹è±¡å ç”¨çš„å†…å­˜")])])])])])]),t._v(" "),n("p",[n("strong",[t._v("åˆ¤æ–­å†…å­˜æ³„æ¼ï¼Œä»¥ heapUsed å­—æ®µä¸ºå‡†ã€‚")])]),t._v(" "),n("p",[t._v("ğŸ“Œ "),n("strong",[t._v("5. æŸ¥æ‰¾ Node.js å†…å­˜æ³„æ¼çš„å·¥å…·")])]),t._v(" "),n("ul",[n("li",[n("p",[n("a",{attrs:{href:"https://github.com/Jimbly/node-mtrace",target:"_blank",rel:"noopener noreferrer"}},[t._v("node-mtrace"),n("OutboundLink")],1),t._v("ï¼Œå®ƒä½¿ç”¨äº† GCC çš„ mtrace å·¥å…·æ¥åˆ†æå †çš„ä½¿ç”¨ã€‚")])]),t._v(" "),n("li",[n("p",[n("a",{attrs:{href:"https://github.com/davepacheco/node-heap-dump",target:"_blank",rel:"noopener noreferrer"}},[t._v("node-heap-dump"),n("OutboundLink")],1),t._v("ï¼Œå®ƒå¯¹ V8 çš„å †æŠ“å–äº†ä¸€å¼ å¿«ç…§å¹¶æŠŠæ‰€æœ‰çš„ä¸œè¥¿åºåˆ—åŒ–æˆä¸€ä¸ªå·¨å¤§çš„ JSON æ–‡ä»¶ï¼Œè¿˜åŒ…å«äº†ä¸€äº›åˆ†æç ”ç©¶å¿«ç…§ç»“æœçš„ JavaScript å·¥å…·ã€‚")])]),t._v(" "),n("li",[n("p",[n("a",{attrs:{href:"https://github.com/node-inspector/v8-profiler",target:"_blank",rel:"noopener noreferrer"}},[t._v("v8-profiler"),n("OutboundLink")],1),t._v(" å’Œ "),n("a",{attrs:{href:"https://github.com/node-inspector/node-inspector",target:"_blank",rel:"noopener noreferrer"}},[t._v("node-inspector"),n("OutboundLink")],1),t._v("ï¼Œæä¾›äº†ç»‘å®šåœ¨ Node.js ä¸­çš„ V8 åˆ†æå™¨å’Œä¸€ä¸ªåŸºäº WebKit Web Inspector çš„ debug ç•Œé¢ã€‚")])]),t._v(" "),n("li",[n("p",[n("a",{attrs:{href:"https://github.com/felixge/node-memory-leak-tutorial",target:"_blank",rel:"noopener noreferrer"}},[t._v("Node.js å†…å­˜æ³„æ¼æŒ‡å¯¼ï¼ˆNode Memory Leak Tutorialï¼‰"),n("OutboundLink")],1),t._v("ï¼Œè¿™æ˜¯ä¸€ä¸ªåˆçŸ­åˆé…·çš„ v8-profiler å’Œ node-debugger ä½¿ç”¨æ•™ç¨‹ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ç›®å‰æœ€å…ˆè¿›çš„ Node.js å†…å­˜æ³„æ¼è°ƒè¯•æŠ€æœ¯æŒ‡å—ã€‚")])]),t._v(" "),n("li",[n("p",[t._v("Joyent çš„ "),n("a",{attrs:{href:"https://www.joyent.com/smartos",target:"_blank",rel:"noopener noreferrer"}},[t._v("SmartOS"),n("OutboundLink")],1),t._v(" å¹³å°ï¼Œå®ƒæä¾›äº†å¤§é‡ç”¨äºè°ƒè¯• Node.js å†…å­˜æ³„æ¼çš„å·¥å…·ã€‚")])]),t._v(" "),n("li",[n("p",[n("a",{attrs:{href:"https://www.npmjs.com/package/memwatch",target:"_blank",rel:"noopener noreferrer"}},[t._v("memwatch"),n("OutboundLink")],1),t._v(" + "),n("a",{attrs:{href:"https://www.npmjs.com/package/heapdump",target:"_blank",rel:"noopener noreferrer"}},[t._v("heapdump"),n("OutboundLink")],1),t._v("ã€‚")]),t._v(" "),n("p",[t._v("è¿™ä¸¤è€…é€‚ç”¨äºå¤§å‹ä¸šåŠ¡ï¼Œå› ä¸ºåªæœ‰åœ¨ CPU å‹åŠ›è¾¾åˆ°ä¸€å®šæ¯”ç‡æ—¶ï¼Œæ‰ä¼šè·³å‡ºæ¥ memwatch leakï¼Œè€Œä¸”è¿‘ä¼¼éšå³ã€‚heapdump æ–‡ä»¶éšç€æ—¶é—´å¢åŠ ï¼Œæ–‡ä»¶å®¹é‡ä¸æ–­æ‰©å¤§ã€‚")]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä¸€ä¸ªâ€œæ³„æ¼â€äº‹ä»¶å‘å°„å™¨")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¦‚æœç»è¿‡è¿ç»­äº”æ¬¡ GCï¼Œå†…å­˜ä»è¢«æŒç»­åˆ†é…è€Œæ²¡æœ‰å¾—åˆ°é‡Šæ”¾")]),t._v("\nmemwatch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'leak'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("info")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" file "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./tmp.heapsnapshot'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  heapdump"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeSnapshot")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("error")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("error")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Wrote snapshotï¼š'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br")])]),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// é€šè¿‡ diff çš„æ–¹å¼æŸ¥æ‰¾çœŸæ­£çš„å…ƒå‡¶")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" hd "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("memwatch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("HeapDiff")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// your code here")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" diff "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" hd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br")])]),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä¸€ä¸ªâ€œçŠ¶æ€â€äº‹ä»¶å‘å°„å™¨")]),t._v("\nmemwatch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'stats'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("stats")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  usage_trend       "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä½¿ç”¨è¶‹åŠ¿")]),t._v("\n  current_base      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å½“å‰åŸºæ•°")]),t._v("\n  estimated_base    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// é¢„æœŸåŸºæ•°")]),t._v("\n  num_full_gc       "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å®Œæ•´çš„åƒåœ¾å›æ”¶æ¬¡æ•°")]),t._v("\n  num_inc_gc        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¢é•¿çš„åƒåœ¾å›æ”¶æ¬¡æ•°")]),t._v("\n  heap_compactions  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å†…å­˜å‹ç¼©æ¬¡æ•°")]),t._v("\n  min               "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æœ€å°")]),t._v("\n  max               "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æœ€å¤§")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br")])])]),t._v(" "),n("li",[n("p",[n("a",{attrs:{href:"https://www.npmjs.com/package/memeye",target:"_blank",rel:"noopener noreferrer"}},[t._v("memeye"),n("OutboundLink")],1),t._v(" æ˜¯è½»é‡çº§çš„ NodeJS è¿›ç¨‹ç›‘è§†å·¥å…·ï¼Œå¯æä¾›è¿›ç¨‹å†…å­˜ã€V8 å †ç©ºé—´å†…å­˜å’Œæ“ä½œç³»ç»Ÿå†…å­˜çš„æ•°æ®å¯è§†åŒ–ã€‚è¿™ä¸ªå·¥å…·æŒºå¥½ç”¨çš„ï¼Œé€‚ç”¨äºå¸¸è§„ä¸šåŠ¡å’Œæ—¥å¸¸å­¦ä¹ ã€‚")])]),t._v(" "),n("li",[n("p",[n("a",{attrs:{href:"https://clinicjs.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Clinic.js"),n("OutboundLink")],1),t._v(" æ˜¯ç›®å‰æœ€å¥½ç”¨ã€æœ€ä¸“ä¸šçš„ Node.js æ€§èƒ½ç›‘æµ‹å·¥å…·ã€‚å¦‚æœæƒ³æ·±å…¥ç ”ç©¶æˆ–è€…å…¬å¸æœ‰é¡¹ç›®å¯¹ Node.js æ¶‰åŠæ¯”è¾ƒæ·±çš„ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨ã€‚")])])]),t._v(" "),n("h2",{attrs:{id:"ç¼–ç è§„èŒƒ"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ç¼–ç è§„èŒƒ"}},[t._v("#")]),t._v(" ç¼–ç è§„èŒƒ")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("å‡½æ•°å†…çš„å˜é‡æ˜¯å¯ä»¥éšç€å‡½æ•°æ‰§è¡Œè¢«å›æ”¶çš„ï¼Œä½†æ˜¯å…¨å±€ä¸è¡Œã€‚å¦‚æœæ˜¯åœ¨ä¸šåŠ¡éœ€æ±‚é‡Œåº”é¿å…ä½¿ç”¨å¯¹è±¡ä½œä¸ºç¼“å­˜ï¼Œå¯ä½¿ç”¨ Redis ç­‰ä¸“é—¨å¤„ç†ç¼“å­˜çš„æŠ€æœ¯ã€‚")]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// demo.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" memeye "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'memeye'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("memeye")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" leakArray "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" server "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("url "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    leakArray"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Math"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("random")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("leakArray"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello world'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br")])]),n("p",[t._v("æ‰§è¡Œ "),n("code",[t._v("node demo")]),t._v("ï¼Œé€šè¿‡ memeye è¿™ä¸ªå·¥å…·æˆ‘ä»¬å¯ä»¥åœ¨æµè§ˆå™¨ä¸­çœ‹åˆ°å…³äºå†…å­˜ä½¿ç”¨çš„ä¸€äº›æƒ…å†µã€‚")]),t._v(" "),n("p",[n("img",{attrs:{src:a(522),alt:"performance",title:"performance"}})]),t._v(" "),n("p",[t._v("è§£å†³æ–¹æ³•å°±æ˜¯å¯ä»¥ä½¿ç”¨å¼±å¼•ç”¨ WeakMap æ¥è§£å†³ã€‚")]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// demo.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" memeye "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'memeye'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("memeye")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" leakArray "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" server "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("url "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" wm "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WeakMap")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    leakArray"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Math"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("random")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    wm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("leakArray"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" leakArray"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("wm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("leakArray"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    leakArray "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello world'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br")])]),n("p",[t._v("ç›¸ä¼¼ä¾‹å­")]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// demo.js")]),t._v("\nglobal"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("gc")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ç¬¬ä¸€æ¬¡'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("memoryUsage")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¿”å›å½“å‰ Node.js ä½¿ç”¨æƒ…å†µ")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" map "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Map")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" key "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Array")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nmap"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nglobal"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("gc")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ç¬¬äºŒæ¬¡'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("memoryUsage")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br")])]),n("p",[t._v("æ‰§è¡Œå‘½ä»¤ "),n("code",[t._v("node --expose-gc demo")]),t._v("ï¼Œå¯ä»¥çœ‹åˆ°è¾“å‡ºäº†ä»¥ä¸‹ç»“æœã€‚")]),t._v(" "),n("p",[t._v("ç¬¬äºŒæ¬¡çš„ heapUsed å€¼æ˜æ˜¾æ¯”ç¬¬ä¸€æ¬¡çš„å¤§äº†å¾ˆå¤šã€‚è¯´æ˜å‘ç”Ÿäº†å†…å­˜æ³„æ¼ã€‚")]),t._v(" "),n("p",[n("img",{attrs:{src:a(523),alt:"performance",title:"performance"}})]),t._v(" "),n("p",[t._v("å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ")]),t._v(" "),n("p",[t._v("ğŸ”” "),n("strong",[t._v("ç›´æ¥å°† key ç½®ä¸º null")])]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// demo.js")]),t._v("\nglobal"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("gc")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ç¬¬ä¸€æ¬¡'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("memoryUsage")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¿”å›å½“å‰ Node.js ä½¿ç”¨æƒ…å†µ")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" map "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Map")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" key "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Array")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nmap"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nglobal"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("gc")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ç¬¬äºŒæ¬¡'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("memoryUsage")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nkey "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç›´æ¥å°† key ç½®ä¸º null æ˜¯æ²¡ç”¨çš„")]),t._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ç¬¬ä¸‰æ¬¡'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("memoryUsage")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br")])]),n("p",[t._v("å¯ä»¥çœ‹åˆ°ï¼Œå°±ç®—æˆ‘ä»¬æŠŠ key ç½®ä¸ºç©ºï¼Œä½¿ç”¨çš„å †å†…å­˜è¿˜æ˜¯é‚£ä¹ˆå¤šï¼Œå¹¶æ²¡æœ‰å‡å°‘ï¼Œè¯´æ˜è¿™ç§æ–¹æ³•ä¸å¯è¡Œã€‚")]),t._v(" "),n("p",[n("img",{attrs:{src:a(524),alt:"performance",title:"performance"}})]),t._v(" "),n("p",[t._v("ğŸ”” "),n("strong",[t._v("å…ˆå°† map å’Œ key ä¹‹é—´çš„å…³ç³»æ¸…æ‰ï¼Œå†æŠŠ key ç½®ä¸º null")])]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// demo.js")]),t._v("\nglobal"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("gc")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ç¬¬ä¸€æ¬¡'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("memoryUsage")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¿”å›å½“å‰ Node.js ä½¿ç”¨æƒ…å†µ")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" map "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Map")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" key "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Array")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nmap"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nglobal"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("gc")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ç¬¬äºŒæ¬¡'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("memoryUsage")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nmap"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("delete")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¦å…ˆå°† map å’Œ key çš„å…³ç³»æ¸…æ‰ï¼Œå†æŠŠ key ç½®ä¸º nullï¼Œæ‰æœ‰æ•ˆ")]),t._v("\nkey "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nglobal"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("gc")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ç¬¬ä¸‰æ¬¡'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("memoryUsage")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br")])]),n("p",[t._v("å¯ä»¥çœ‹åˆ°ï¼Œè¿™ç§æ–¹æ³•æ˜¯å¯è¡Œçš„ã€‚ç¬¬ä¸‰æ¬¡çš„æ—¶å€™å †å†…å­˜çš„å‡å°‘äº†ï¼Œä¸è¿‡å¹¶æ²¡æœ‰å›åˆ°æœ€å¼€å§‹çš„å€¼ï¼Œè¿™æ˜¯å› ä¸ºä»£ç ä¹Ÿä¼šå ç”¨éƒ¨åˆ†å†…å­˜ã€‚ä¸è¿‡ï¼Œè¿™ç§æ–¹æ³•æœ‰ç‚¹éº»çƒ¦ï¼Œè¿˜æœ‰æ›´ç®€ä¾¿çš„è§£å†³æ–¹æ³•ã€‚")]),t._v(" "),n("p",[n("img",{attrs:{src:a(525),alt:"performance",title:"performance"}})]),t._v(" "),n("p",[t._v("ğŸ”” "),n("strong",[t._v("ä½¿ç”¨å¼±å¼•ç”¨ WeakMap è§£å†³")])]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// demo.js")]),t._v("\nglobal"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("gc")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ç¬¬ä¸€æ¬¡'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("memoryUsage")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¿”å›å½“å‰ Node.js ä½¿ç”¨æƒ…å†µ")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" wm "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WeakMap")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" key "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Array")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nwm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nkey "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç”¨å¼±å¼•ç”¨ WeakMap çš„è¯ï¼Œç›´æ¥å°† key ç½®ä¸º null å°±å¯ä»¥äº†")]),t._v("\nglobal"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("gc")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ç¬¬äºŒæ¬¡'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("memoryUsage")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br")])]),n("p",[t._v("å¯ä»¥çœ‹åˆ°ï¼Œè¿™ç§æ–¹æ³•ä¹Ÿæ˜¯å®Œå…¨å¯è¡Œçš„ã€‚")]),t._v(" "),n("p",[n("img",{attrs:{src:a(526),alt:"performance",title:"performance"}})])]),t._v(" "),n("li",[n("p",[t._v("æ¶ˆè´¹é˜Ÿåˆ—ä¸åŠæ—¶")]),t._v(" "),n("p",[t._v("è¿™ä¹Ÿæ˜¯ä¸€ä¸ªä¸ç»æ„é—´äº§ç”Ÿçš„å†…å­˜æ³„æ¼ã€‚é˜Ÿåˆ—ä¸€èˆ¬åœ¨æ¶ˆè´¹è€…-ç”Ÿäº§è€…æ¨¡å‹ä¸­å……å½“ä¸­é—´äººçš„è§’è‰²ï¼Œå½“æ¶ˆè´¹å¤§äºç”Ÿäº§æ—¶æ²¡é—®é¢˜ï¼Œä½†æ˜¯å½“ç”Ÿäº§å¤§äºæ¶ˆè´¹æ—¶ï¼Œä¼šäº§ç”Ÿå †ç§¯ï¼Œå°±å®¹æ˜“å‘ç”Ÿå†…å­˜æ³„æ¼ã€‚")]),t._v(" "),n("p",[t._v("æ¯”å¦‚æ”¶é›†æ—¥å¿—ï¼Œå¦‚æœæ—¥å¿—äº§ç”Ÿçš„é€Ÿåº¦å¤§äºæ–‡ä»¶å†™å…¥çš„é€Ÿåº¦ï¼Œå°±å®¹æ˜“äº§ç”Ÿå†…å­˜æ³„æ¼ï¼ˆJmeter æ¥æ”¶åˆ°å…¨éƒ¨è¿”å›åï¼ŒæœåŠ¡å™¨ log4js æ—¥å¿—è¿˜åœ¨ä¸åœå†™ï¼‰ï¼Œè¡¨å±‚çš„è§£å†³æ–¹æ³•æ˜¯æ¢ç”¨æ¶ˆè´¹é€Ÿåº¦æ›´é«˜çš„æŠ€æœ¯ï¼Œä½†æ˜¯è¿™ä¸æ²»æœ¬ã€‚æ ¹æœ¬çš„è§£å†³æ–¹æ¡ˆåº”è¯¥æ˜¯"),n("strong",[t._v("ç›‘æ§é˜Ÿåˆ—çš„é•¿åº¦ä¸€æ—¦å †ç§¯å°±æŠ¥è­¦æˆ–æ‹’ç»æ–°çš„è¯·æ±‚")]),t._v("ï¼Œè¿˜æœ‰ä¸€ç§æ˜¯"),n("strong",[t._v("æ‰€æœ‰çš„å¼‚æ­¥è°ƒç”¨éƒ½æœ‰è¶…æ—¶å›è°ƒï¼Œä¸€æ—¦è¾¾åˆ°æ—¶é—´è°ƒç”¨æœªå¾—åˆ°ç»“æœå°±æŠ¥è­¦")]),t._v("ã€‚")])]),t._v(" "),n("li",[n("p",[t._v("é—­åŒ…")]),t._v(" "),n("p",[t._v("é—­åŒ…ä¸€å®šä¼šé€ æˆå†…å­˜æ³„æ¼ï¼Œä½†æ˜¯é—­åŒ…å¹¶ä¸å¯æ€•ï¼Œå¯æ€•çš„æ˜¯åœ¨é—­åŒ…é‡Œå¼•ç”¨äº†ä¸€ä¸ªå¤§å¯¹è±¡ã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨å†™é—­åŒ…çš„æ—¶å€™ï¼Œ"),n("strong",[t._v("ä¸è¦ä¼ æ•´ä¸ªå¤§çš„å¯¹è±¡ï¼Œè€Œæ˜¯éœ€è¦å“ªä¸ªå±æ€§å°±ä¼ é‚£ä¸ªå±æ€§å°±è¡Œäº†")]),t._v("ï¼Œè¿™æ˜¯å†™é—­åŒ…æ—¶çš„ä¸€ä¸ªå°æŠ€å·§ã€‚æ¯”å¦‚ï¼š")]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("foo")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" temp_object "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    x"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    y"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    array"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Array")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("200000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" closure "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" temp_object"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("closure"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br")])]),n("p",[t._v("è§£å†³é—­åŒ…é€ æˆçš„å†…å­˜æ³„æ¼å…¶å®å¾ˆç®€å•ï¼Œé™¤äº†ä¸Šé¢è¯´çš„ï¼Œè¿˜å¯ä»¥"),n("strong",[t._v("å°†å¯¹è±¡ç½®ä¸º null")]),t._v(" æˆ–è€…"),n("strong",[t._v("ä½¿ç”¨ WeakMap")]),t._v(" æ¥è§£å†³ã€‚")])]),t._v(" "),n("li",[n("p",[t._v("é¢‘ç¹çš„åƒåœ¾å›æ”¶è®© GC æ— æœºä¼šå·¥ä½œ")]),t._v(" "),n("p",[n("img",{attrs:{src:a(527),alt:"performance",title:"performance"}})]),t._v(" "),n("p",[n("img",{attrs:{src:a(528),alt:"performance",title:"performance"}})])]),t._v(" "),n("li",[n("p",[t._v("perf_hooksï¼ˆæ€§èƒ½é’©å­ï¼‰")]),t._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api/perf_hooks.html#perf_hooks_performance_measurement_apis",target:"_blank",rel:"noopener noreferrer"}},[t._v("perf_hooks"),n("OutboundLink")],1),t._v(" æ˜¯ Node.js çš„æ€§èƒ½ç›‘æ§ APIï¼Œå¯ä»¥é€šè¿‡è°ƒç”¨ mark() å’Œ measure() APIï¼Œç›‘æ§ Node.js äº‹ä»¶æ‰§è¡Œæ—¶é—´ã€‚")]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åŠæ—¶ç»Ÿè®¡ä»£ç è¿è¡Œ AB æ¯”è¾ƒ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// é¿å…ä»£ç æ‰§è¡Œé€»è¾‘è¿‡äºå¤æ‚ï¼Œæ—  GC æœºä¼š")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" performance "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'perf_hooks'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nperformance"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("mark")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'A'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  performance"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("mark")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'B'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  performance"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("measure")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'A to B'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'A'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'B'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" entry "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" performance"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getEntriesByName")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'A to B'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'measure'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("entry"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("duration"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br")])])])])])}),[],!1,null,null,null);s.default=e.exports}}]);