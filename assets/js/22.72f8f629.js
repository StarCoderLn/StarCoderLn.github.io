(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{331:function(s,n,e){s.exports=e.p+"assets/img/linux4.84b97ec3.png"},332:function(s,n,e){s.exports=e.p+"assets/img/linux1.c934a9d8.png"},333:function(s,n,e){s.exports=e.p+"assets/img/linux2.a4a90059.png"},334:function(s,n,e){s.exports=e.p+"assets/img/linux3.fef70773.png"},335:function(s,n,e){s.exports=e.p+"assets/img/linux5.40023a27.png"},336:function(s,n,e){s.exports=e.p+"assets/img/linux6.384eebec.png"},337:function(s,n,e){s.exports=e.p+"assets/img/linux7.772764ce.png"},338:function(s,n,e){s.exports=e.p+"assets/img/linux8.2b9988d8.png"},339:function(s,n,e){s.exports=e.p+"assets/img/linux9.ecc23f27.png"},774:function(s,n,e){"use strict";e.r(n);var t=e(33),a=Object(t.a)({},(function(){var s=this,n=s.$createElement,t=s._self._c||n;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"linux-常用命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#linux-常用命令"}},[s._v("#")]),s._v(" Linux 常用命令")]),s._v(" "),t("p",[t("code",[s._v("Linux")]),s._v(" 常用命令的使用可以参考："),t("a",{attrs:{href:"http://www.jsons.cn/linuxcode/#",target:"_blank",rel:"noopener noreferrer"}},[s._v("Linux常用命令大全"),t("OutboundLink")],1)]),s._v(" "),t("blockquote",[t("p",[s._v("补充："),t("code",[s._v("Windows")]),s._v(" 常用命令的使用可以参考："),t("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/windows-server/administration/windows-commands/windows-commands",target:"_blank",rel:"noopener noreferrer"}},[s._v("Windows 命令"),t("OutboundLink")],1)])]),s._v(" "),t("h2",{attrs:{id:"linux-配置免密登录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#linux-配置免密登录"}},[s._v("#")]),s._v(" Linux 配置免密登录")]),s._v(" "),t("p",[s._v("正常我们想访问服务器，是需要输入密码的。")]),s._v(" "),t("p",[t("img",{attrs:{src:e(331),alt:"linux",title:"linux"}})]),s._v(" "),t("p",[s._v("免密登录就是让我们省去输入密码这一步，直接就能访问服务器。")]),s._v(" "),t("p",[t("strong",[s._v("1. 免密登录原理")])]),s._v(" "),t("ul",[t("li",[t("p",[s._v("ssh 的前身就是 telnet 协议，ssh 就包含了 ssl 协议。ssh 和 ssl 的关系就跟 HTTPS 和 HTTP 的关系一样。ssh 就是带加密的 telnet 协议。")])]),s._v(" "),t("li",[t("p",[s._v("使用通过 ssh 协议生成的非对称加密秘钥进行连接，同步公钥到服务端，每次请求的服务器时，服务器验证是否存在公钥，会使用公钥加密一段信息传输到客户端，客户端再使用配对的私钥解密进行验证，从而验证客户端登录。")])])]),s._v(" "),t("p",[t("strong",[s._v("2. 详细流程")])]),s._v(" "),t("ul",[t("li",[t("p",[s._v("在客户端使用 ssh-keygen 生成一对密钥：公钥 + 私钥")])]),s._v(" "),t("li",[t("p",[s._v("将客户端公钥追加到服务端的 authorized_key 文件中，完成公钥认证操作")])]),s._v(" "),t("li",[t("p",[s._v("认证完成后，客户端向服务端发起登录请求，并传递公钥到服务端")])]),s._v(" "),t("li",[t("p",[s._v("服务端检索 authorized_key 文件，确认该公钥是否存在")])]),s._v(" "),t("li",[t("p",[s._v("如果存在该公钥，则生成随机数R，并用公钥来进行加密，生成公钥加密字符串 pubKey(R)")])]),s._v(" "),t("li",[t("p",[s._v("将公钥加密字符串传递给客户端")])]),s._v(" "),t("li",[t("p",[s._v("客户端使用私钥解密公钥加密字符串，得到 R")])]),s._v(" "),t("li",[t("p",[s._v("服务端和客户端通信时会产生一个会话 ID(sessionKey)，用 MD5 对 R 和 SessionKey 进行加密，生成摘要（即 MD5 加密字符串）")])]),s._v(" "),t("li",[t("p",[s._v("客户端将生成的 MD5 加密字符串传给服务端")])]),s._v(" "),t("li",[t("p",[s._v("服务端同样生成 MD5(R,SessionKey) 加密字符串")])]),s._v(" "),t("li",[t("p",[s._v("如果客户端传来的加密字符串等于服务端自身生成的加密字符串，则认证成功")])]),s._v(" "),t("li",[t("p",[s._v("此时不用输入密码，即完成建连，可以开始远程执行 shell 命令了")])])]),s._v(" "),t("p",[t("strong",[s._v("3. 生成密钥")])]),s._v(" "),t("p",[s._v("ssh-keygen 用于生成公钥和私钥。常用的参数如下：")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("-t: 指定生成密钥类型（rsa、dsa）。默认为rsa")])]),s._v(" "),t("li",[t("p",[s._v("-f: 指定存放私钥的文件，公钥文件名为私钥文件名加 .pub 后缀。默认为 id_rsa")])]),s._v(" "),t("li",[t("p",[s._v("-P: 指定 passphrase（私钥的密码），用于确保私钥的安全。默认为空")])]),s._v(" "),t("li",[t("p",[s._v("-C: 备注。默认为 user@hostname")])])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("ssh-keygen -t rsa -C "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"you_set_name"')]),s._v(" -f "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"you_set_name_rsa"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("strong",[s._v("4. 上传公钥")])]),s._v(" "),t("p",[s._v("ssh-copy-id 用于将公钥上传到服务器的 "),t("code",[s._v("/root/.ssh/authorized_keys")]),s._v(" 文件中。")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("ssh-copy-id -i you_set_name_rsa.pub root@服务器ip/域名\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("在这一步中，一开始我用的是服务器的私网 IP：172.18.238.35。结果一直出现以下问题：")]),s._v(" "),t("p",[t("img",{attrs:{src:e(332),alt:"linux",title:"linux"}})]),s._v(" "),t("p",[s._v("试着 ping 一下发现 ping 不通。后来换成了公网 IP：120.78.199.123。就可以了。")]),s._v(" "),t("p",[t("img",{attrs:{src:e(333),alt:"linux",title:"linux"}})]),s._v(" "),t("p",[s._v("此时，在服务器中查看 authorized_keys 文件的内容就发现已经有我们上传的公钥了。")]),s._v(" "),t("p",[t("img",{attrs:{src:e(334),alt:"linux",title:"linux"}})]),s._v(" "),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),t("p",[s._v("要确保公钥文件的访问权限是600，即 "),t("code",[s._v("-rw-------")]),s._v("。")])]),s._v(" "),t("p",[t("strong",[s._v("5. 通过指定私钥的方式访问服务器")])]),s._v(" "),t("p",[s._v("现在，我们就可以通过指定私钥的方式来登录服务器了。如果想退出服务器，直接输入 "),t("code",[s._v("exit")]),s._v(" 命令然后回车就行了。")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" -i id_rsa root@120.78.199.123\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:e(335),alt:"linux",title:"linux"}})]),s._v(" "),t("p",[s._v("但是，由于我之前在自己本地生成私钥的时候设置了访问密码，所以现在还得输入密码。要配置免密登录的话得把这个密码给去掉。")]),s._v(" "),t("p",[s._v("更改本地私钥的访问密码的方法如下：")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("在终端下输入 "),t("code",[s._v("ssh-keygen -p")]),s._v("。")])]),s._v(" "),t("li",[t("p",[s._v("系统会提示选择需要修改的私钥，在我的电脑上默认是 /var/root/.ssh/id_rsa。")])]),s._v(" "),t("li",[t("p",[s._v("选好文件后按回车，会提示输入旧密码。")])]),s._v(" "),t("li",[t("p",[s._v("输入好后会提示输入新密码。")])]),s._v(" "),t("li",[t("p",[s._v("连续两次回车，之前设置的私钥密码就被清除了。")])])]),s._v(" "),t("p",[t("img",{attrs:{src:e(336),alt:"linux",title:"linux"}})]),s._v(" "),t("p",[s._v("再次访问服务器可以看到，可以直接登录了，不需要再输入密码。")]),s._v(" "),t("p",[t("img",{attrs:{src:e(337),alt:"linux",title:"linux"}})]),s._v(" "),t("p",[t("strong",[s._v("6. 更简便的访问方式")])]),s._v(" "),t("p",[s._v("上面我们虽然已经实现了 Linux 免密登录，但是需要我们输入的那行命令还是有点太长了。我们可以通过配置免密登录功能的本地配置文件来缩短这行命令。")]),s._v(" "),t("ul",[t("li",[s._v("编辑自己的 home 目录下（也就是路径显示为 ～）的 .ssh 目录中的 config 文件。默认情况下，.ssh 目录中要么为空，要么只有以下内容。其中 known_hosts 文件是你在第一次登录任何服务器的时候生成的文件。因此，我们需要在这里面创建一个 config 文件："),t("code",[s._v("touch config")]),s._v("。")])]),s._v(" "),t("p",[t("img",{attrs:{src:e(338),alt:"linux",title:"linux"}})]),s._v(" "),t("ul",[t("li",[t("p",[s._v("配置 config 文件的访问权限为644。")])]),s._v(" "),t("li",[t("p",[s._v("免密配置文件 config 的模版如下：")])])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 多主机配置，适用于同一个私钥给多台服务器使用的情况")]),s._v("\nHost gateway-produce\nHostName IP或绑定的域名\nPort "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("\nHost node-produce\nHostName IP或绑定的域名\nPort "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("\nHost java-produce\nHostName IP或绑定的域名\nPort "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("\n\nHost *-produce  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# * 为通配符，匹配所有-produce 的服务器")]),s._v("\nUser root\nIdentityFile ~/.ssh/produce_key_rsa\nProtocol "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\nCompression "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\nServerAliveInterval "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v("\nServerAliveCountMax "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v("\nLogLevel INFO\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#单主机配置，适用于一个私钥只给一台服务器使用的情况")]),s._v("\nHost star-cloud                  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 给服务器取的别名")]),s._v("\nUser root                        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 登录服务器的用户名")]),s._v("\nHostName IP或绑定的域名            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 服务器的 IP 地址或域名，注意前面不要加协议")]),s._v("\nIdentityFile ~/.ssh/id_rsa       "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 私钥文件")]),s._v("\nProtocol "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\nCompression "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\nServerAliveInterval "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v("\nServerAliveCountMax "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v("\nLogLevel INFO\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#单主机配置")]),s._v("\nHost git.yideng.site\nUser "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v("\nIdentityFile ~/.ssh/evilboy_rsa\nProtocol "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\nCompression "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\nServerAliveInterval "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v("\nServerAliveCountMax "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v("\nLogLevel INFO\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br")])]),t("ul",[t("li",[s._v("进入到 home 目录下的 .ssh 目录中，通过以下命令将私钥复制一份到这里。")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /var/root/.ssh/id_rsa id_rsa\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),t("p",[s._v("要确保私钥文件的访问权限是600，即 "),t("code",[s._v("-rw-------")]),s._v("。")])]),s._v(" "),t("ul",[t("li",[s._v("我自己电脑上配置的 config 文件内容如下：")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("Host starcoderln\nUser root\nHostName 120.78.199.123\nIdentityFile ~/.ssh/id_rsa\nProtocol 2\nCompression yes\nServerAliveInterval 60\nServerAliveCountMax 20\nLogLevel INFO\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("ul",[t("li",[s._v("现在，就可以直接用 "),t("code",[s._v("ssh starcoderln")]),s._v(" 命令登录服务器啦～ 😄")])]),s._v(" "),t("p",[t("img",{attrs:{src:e(339),alt:"linux",title:"linux"}})])])}),[],!1,null,null,null);n.default=a.exports}}]);